<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cookie Conversion Utility</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
    
    :root {
      --primary: #333333;
      --primary-dark: #1a1a1a;
      --secondary: #666666;
      --text-dark: #111111;
      --text-light: #777777;
      --bg-light: #f8f9fa;
      --bg-white: #ffffff;
      --shadow: 0 10px 30px rgba(0,0,0,0.08);
      --border-radius: 14px;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #f5f5f5 0%, #e5e5e5 100%);
      color: var(--text-dark);
      min-height: 100vh;
      padding: 40px 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }
    
    .app-header {
      text-align: center;
      margin-bottom: 40px;
    }
    
    h1 {
      font-weight: 700;
      font-size: 2.8rem;
      color: var(--primary);
      margin-bottom: 12px;
      text-shadow: 0 2px 10px rgba(67, 97, 238, 0.2);
    }
    
    .cookie-icon {
      font-size: 3.5rem;
      margin-bottom: 10px;
      color: #333333;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    
    p.subtitle {
      margin-bottom: 15px;
      font-weight: 400;
      font-size: 1.1rem;
      max-width: 600px;
      text-align: center;
      color: var(--text-light);
    }
    
    .container {
      background: var(--bg-white);
      border-radius: var(--border-radius);
      padding: 40px;
      max-width: 800px;
      width: 100%;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
    }
    
    .input-group {
      margin-bottom: 25px;
    }
    
    label {
      font-weight: 600;
      font-size: 1.05rem;
      display: block;
      margin-bottom: 12px;
      color: var(--text-dark);
    }
    
    .file-input-wrapper {
      position: relative;
      width: 100%;
      height: 100px;
      border: 2px dashed #ccc;
      border-radius: var(--border-radius);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      background: #f8f8f8;
      transition: all 0.3s ease;
      overflow: hidden;
    }
    
    .file-input-wrapper:hover {
      border-color: var(--primary);
      background: #efefef;
    }
    
    .file-input-wrapper.active {
      border-color: var(--primary);
      background: #efefef;
    }
    
    .file-input-message {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 20px;
    }
    
    .file-input-message i {
      font-size: 2rem;
      color: var(--primary);
      margin-bottom: 10px;
    }
    
    .file-input-message span {
      font-weight: 500;
      color: var(--text-light);
    }
    
    input[type="file"] {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }
    
    .select-wrapper {
      position: relative;
    }
    
    select {
      width: 100%;
      padding: 15px 20px;
      border-radius: var(--border-radius);
      border: 2px solid #e9ecef;
      background: var(--bg-white);
      color: var(--text-dark);
      font-weight: 500;
      font-size: 1rem;
      transition: all 0.3s ease;
      appearance: none;
      cursor: pointer;
    }
    
    .select-wrapper::after {
      content: "\f107";
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-light);
      pointer-events: none;
    }
    
    select:hover, select:focus {
      border-color: var(--primary);
      outline: none;
    }
    
    .button-row {
      display: flex;
      gap: 15px;
      margin-bottom: 30px;
    }
    
    button {
      flex: 1;
      padding: 16px 0;
      font-size: 1.1rem;
      font-weight: 600;
      border-radius: var(--border-radius);
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    #processBtn {
      background: var(--primary);
      color: white;
      box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
    }
    
    #processBtn:hover:not(:disabled) {
      background: var(--primary-dark);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
      transform: translateY(-2px);
    }
    
    #downloadBtn {
      background: var(--secondary);
      color: white;
      box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
    }
    
    #downloadBtn:hover:not(:disabled) {
      background: #444444;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
      transform: translateY(-2px);
    }
    
    button:disabled {
      background: #e9ecef;
      cursor: not-allowed;
      box-shadow: none;
      color: #adb5bd;
    }
    
    .output-container {
      position: relative;
      margin-top: 10px;
    }
    
    .output-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .output-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-dark);
    }
    
    #output {
      background: #f5f5f5;
      border-radius: var(--border-radius);
      padding: 20px;
      max-height: 300px;
      overflow-y: auto;
      font-family: 'Consolas', 'Courier New', monospace;
      font-size: 0.95rem;
      line-height: 1.5;
      border: 2px solid #e0e0e0;
      white-space: pre-wrap;
      word-break: break-word;
      color: var(--text-dark);
      transition: all 0.3s ease;
    }
    
    #output::-webkit-scrollbar {
      width: 8px;
    }
    
    #output::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }
    
    #output::-webkit-scrollbar-thumb {
      background: #c1c8d1;
      border-radius: 10px;
    }
    
    #output::-webkit-scrollbar-thumb:hover {
      background: #a8b1bd;
    }
    
    .guide {
      margin-top: 40px;
      background: var(--bg-white);
      border-radius: var(--border-radius);
      padding: 30px;
      max-width: 800px;
      width: 100%;
      box-shadow: var(--shadow);
    }
    
    .guide h2 {
      font-size: 1.6rem;
      color: var(--primary);
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .guide table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .guide th, .guide td {
      padding: 15px;
      text-align: left;
      border-bottom: 1px solid #e9ecef;
    }
    
    .guide th {
      font-weight: 600;
      color: var(--text-dark);
      background-color: #f8f9fa;
    }
    
    .guide td {
      font-weight: 400;
      color: var(--text-light);
    }
    
    .guide td:first-child {
      width: 70px;
      text-align: center;
      font-size: 1.3rem;
      color: var(--primary);
      font-weight: 700;
    }
    
    code {
      background: #f0f0f0;
      padding: 3px 6px;
      border-radius: 4px;
      font-family: 'Consolas', 'Courier New', monospace;
      color: var(--primary);
    }
    
    @media (max-width: 768px) {
      .container, .guide {
        padding: 25px;
      }
      
      h1 {
        font-size: 2.2rem;
      }
      
      .cookie-icon {
        font-size: 2.8rem;
      }
    }
    
    @media (max-width: 576px) {
      .button-row {
        flex-direction: column;
      }
      
      .container, .guide {
        padding: 20px;
      }
      
      .file-input-wrapper {
        height: 80px;
      }
      
      .guide td, .guide th {
        padding: 10px;
      }
    }
    
    /* Animation */
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    .pulse {
      animation: pulse 1.5s infinite;
    }
  </style>
</head>
<body>
  <div class="app-header">
    <div class="cookie-icon"><i class="fas fa-cookie-bite"></i></div>
    <h1>Cookie Conversion Utility</h1>
    <p class="subtitle">Cung cấp số lượng lớn Cookie BOT EU - MIX - ONLY 250 - BM - PAGE</p>
    <p class="subtitle">Mua hàng : @Ducmanhjay</p>
  </div>
  
  <div class="container">
    <div class="input-group">
      <label for="folderInput"><i class="fas fa-folder-open"></i> Chọn thư mục:</label>
      <div class="file-input-wrapper" id="dropzone">
        <div class="file-input-message">
          <i class="fas fa-cloud-upload-alt"></i>
          <span>Nhấp hoặc kéo thả thư mục chứa file cookie</span>
        </div>
        <input type="file" id="folderInput" webkitdirectory directory multiple />
      </div>
    </div>
    
    <div class="input-group">
      <label for="formatSelect"><i class="fas fa-file-code"></i> Chọn định dạng convert:</label>
      <div class="select-wrapper">
        <select id="formatSelect">
          <option value="string">Cookie String (Dạng chuỗi)</option>
          <option value="json">JSON (JavaScript Object Notation)</option>
          <option value="netscape">Netscape (Định dạng NetScape)</option>
        </select>
      </div>
    </div>
    
    <div class="button-row">
      <button id="processBtn" disabled><i class="fas fa-cogs"></i> Xử lý file</button>
      <button id="downloadBtn" style="display:none;"><i class="fas fa-download"></i> Tải file ZIP</button>
    </div>
    
    <div class="output-container">
      <div class="output-header">
        <div class="output-title"><i class="fas fa-terminal"></i> Kết quả</div>
      </div>
      <pre id="output">Chưa có file nào được chọn.</pre>
    </div>
  </div>
  
  <div class="guide">
    <h2><i class="fas fa-book"></i> Hướng Dẫn Sử Dụng</h2>
    <table>
      <thead>
        <tr>
          <th>Bước</th>
          <th>Mô tả</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1</td>
          <td>Nhấn vào <strong>Chọn thư mục</strong> và chọn thư mục gồm tất cả các file BOT</td>
        </tr>
        <tr>
          <td>2</td>
          <td>Chọn định dạng cookie mong muốn (String, JSON hoặc Netscape).</td>
        </tr>
        <tr>
          <td>3</td>
          <td>Nhấn nút <strong>Xử lý file</strong> để tiến hành convert toàn bộ file.</td>
        </tr>
        <tr>
          <td>4</td>
          <td>Khi hoàn tất, nhấn <strong>Tải file ZIP</strong> để tải tất cả kết quả về máy.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script>
    const folderInput = document.getElementById('folderInput');
    const formatSelect = document.getElementById('formatSelect');
    const processBtn = document.getElementById('processBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const output = document.getElementById('output');
    const dropzone = document.getElementById('dropzone');

    let filesToProcess = [];
    let zip = new JSZip();

    // Add dropzone effects
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      dropzone.addEventListener(eventName, preventDefaults, false);
    });
    
    function preventDefaults(e) {
      e.preventDefault();
      e.stopPropagation();
    }
    
    ['dragenter', 'dragover'].forEach(eventName => {
      dropzone.addEventListener(eventName, () => {
        dropzone.classList.add('active');
      }, false);
    });
    
    ['dragleave', 'drop'].forEach(eventName => {
      dropzone.addEventListener(eventName, () => {
        dropzone.classList.remove('active');
      }, false);
    });

    function detectAndParse(text) {
      text = text.trim();
      try {
        const arr = JSON.parse(text);
        if (Array.isArray(arr) && arr.every(c => c.name && c.value)) {
          return arr.map(c => ({
            name: c.name,
            value: c.value,
            domain: c.domain || ".",
            path: c.path || "/",
            expires: c.expires || 2147483647,
            secure: c.secure || false,
            httpOnly: c.httpOnly || false
          }));
        }
      } catch {}
      const lines = text.split('\n').map(l => l.trim()).filter(l => l && !l.startsWith('#'));
      if (lines.length && lines.every(l => l.split('\t').length >= 7)) {
        return lines.map(l => {
          const p = l.split('\t');
          return {
            domain: p[0],
            path: p[2],
            secure: p[3].toUpperCase() === "TRUE",
            expires: parseInt(p[4], 10) || 2147483647,
            name: p[5],
            value: p[6],
            httpOnly: p[0].startsWith("#HttpOnly_")
          };
        });
      }
      const parts = text.split(';').map(s => s.trim()).filter(s => s.includes('='));
      if (parts.length) {
        return parts.map(s => {
          const [n, ...rest] = s.split('=');
          return { name: n.trim(), value: rest.join('=').trim(), domain:".", path:"/", expires:2147483647, secure:false, httpOnly:false };
        });
      }
      throw new Error("Không nhận diện được định dạng cookie trong file.");
    }

    function convertCookies(cookies, format) {
      if (format === "json") {
        return JSON.stringify(cookies.map(c => ({
          name: c.name,
          value: c.value,
          domain: c.domain,
          path: c.path,
          expires: c.expires,
          secure: c.secure,
          httpOnly: c.httpOnly
        })), null, 2);
      } else if (format === "netscape") {
        return cookies.map(c => 
          `${c.domain}\tTRUE\t${c.path}\t${c.secure ? "TRUE" : "FALSE"}\t${c.expires}\t${c.name}\t${c.value}`
        ).join("\n");
      } else { // string
        return cookies.map(c => `${c.name}=${c.value}`).join("; ");
      }
    }

    folderInput.addEventListener('change', () => {
      filesToProcess = Array.from(folderInput.files).filter(f => f.name === 'Cookies_JSON.txt');
      output.textContent = '';
      downloadBtn.style.display = 'none';
      processBtn.disabled = true;
      if (filesToProcess.length > 0) {
        processBtn.disabled = false;
        dropzone.classList.add('active');
        output.textContent = `TÌM THẤY ${filesToProcess.length} FILE COOKIE\n`;
      } else {
        dropzone.classList.remove('active');
        output.textContent = 'Không tìm thấy file Cookie nào trong thư mục bạn chọn.';
      }
    });

    processBtn.addEventListener('click', () => {
      output.textContent = 'Đang xử lý...';
      processBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Đang xử lý';
      zip = new JSZip();
      let count = 0;
      filesToProcess.sort((a, b) => {
        const dirA = a.webkitRelativePath.split('/')[0].toLowerCase();
        const dirB = b.webkitRelativePath.split('/')[0].toLowerCase();
        return dirA.localeCompare(dirB);
      });

      filesToProcess.forEach((file, index) => {
        const reader = new FileReader();
        reader.onload = (e) => {
          const rawText = e.target.result;
          let cookies;
          try {
            cookies = detectAndParse(rawText);
          } catch (err) {
            output.textContent += `\n File ${file.webkitRelativePath} lỗi parse cookie: ${err.message}`;
            count++;
            if (count === filesToProcess.length) {
              finishZip();
            }
            return;
          }

          const converted = convertCookies(cookies, formatSelect.value);
          const folderName = file.webkitRelativePath.split('/')[0];
          const order = String(index + 1).padStart(2, '0');
          const fileName = `${order}_${folderName}_Cookies_${formatSelect.value}.txt`;

          zip.file(fileName, converted);

          output.textContent += `\n ${order}. ${file.webkitRelativePath} → ${fileName}`;

          count++;
          if (count === filesToProcess.length) {
            finishZip();
          }
        };
        reader.readAsText(file);
      });

      function finishZip() {
        output.textContent += '\n\n Xử lý hoàn tất! Bạn có thể tải file ZIP.';
        downloadBtn.style.display = 'inline-flex';
        downloadBtn.classList.add('pulse');
        processBtn.innerHTML = '<i class="fas fa-check-circle"></i> Đã xử lý xong';
        processBtn.disabled = true;
      }
    });

    downloadBtn.addEventListener('click', () => {
      downloadBtn.disabled = true;
      downloadBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Đang tạo ZIP';
      output.textContent += '\n⏳ Đang tạo file ZIP...';

      zip.generateAsync({ type: "blob" }).then(content => {
        const link = document.createElement('a');
        link.href = URL.createObjectURL(content);
        link.download = 'Cookies_Converted_Files.zip';
        link.click();
        downloadBtn.disabled = false;
        downloadBtn.innerHTML = '<i class="fas fa-download"></i> Tải file ZIP';
        downloadBtn.classList.remove('pulse');
        output.textContent += '\n Đã tải xong.';
      });
    });
  </script>
</body>
</html>
